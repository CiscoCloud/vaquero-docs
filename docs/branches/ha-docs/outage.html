<head>
            
<meta charset="UTF-8"> <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--> <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
Vaquero Getting Started
</title>
            
<link rel="stylesheet" type="text/css" href="../doc.css"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400"> <link rel='shortcut icon' href='cow.png' type='image/x-icon'/ >
<style>
                .markdown-body {
                    box-sizing: border-box;
                    min-width: 200px;
                    max-width: 1200px;
                    margin: 0 auto;
                    padding: 45px;
                }
            </style>
</head><article class="markdown-body">

<h1 id="outage-scenarios-and-vaquero-behaviors">Outage Scenarios and Vaquero Behaviors</h1>
<p><a href="https://ciscocloud.github.io/vaquero-docs/">Home</a> | <a href="https://github.com/CiscoCloud/vaquero-docs/tree/master">Docs Repo</a></p>
<p>This document outlines vaquero's functionality in outage scenarios. In this analysis we are looking at a deployment of 3 vaquero servers. <img src="jan17HA.png" /></p>
<ul>
<li>SoT : Source of Truth: the home for the data model</li>
<li>VS : Vaquero Server</li>
<li>VA : Vaquero Agent</li>
<li>KV : Key value storage</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Outage</th>
<th align="left">Effected Vaquero Functionality</th>
<th align="left">Acceptable Outage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SoT -&gt; VS</td>
<td align="left">Vaquero Server cannot update its source of truth, it will assume it has the most recent model.</td>
<td align="left">Y (potential for stale DM)</td>
</tr>
<tr class="even">
<td align="left">VS -&gt; VA</td>
<td align="left">The Vaquero Agents will not be able to update state or fetch new data models. Agents will continue to act as if they have the most recent model.</td>
<td align="left">Y (potential for stale DM)</td>
</tr>
<tr class="odd">
<td align="left">Active VS leader down</td>
<td align="left">If the active VS goes down, a passively campaigning VS will take on the role of active</td>
<td align="left">Y</td>
</tr>
<tr class="even">
<td align="left">Passive VS down</td>
<td align="left">If a campaigning VS goes down, the cluster will be unaffected</td>
<td align="left">Y (but fewer HA servers in case of additional server outages)</td>
</tr>
<tr class="odd">
<td align="left">All VS down</td>
<td align="left">If the entire cluster of VS machines goes down (including a sole running VS), this is catastrophic because nothing is serving to the VAs</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">VA Outage</td>
<td align="left">A VA outage would be catastrophic for the site that agent is mangaging, but will have no effects across the system or other Agents</td>
<td align="left">Y for system as a whole</td>
</tr>
<tr class="odd">
<td align="left">VS Load Balancer / VirtualIP</td>
<td align="left">System will still work if only one vaquero server is up and being reached directly by the SoTs, users and agents.</td>
<td align="left">Y (given routable VS)</td>
</tr>
<tr class="even">
<td align="left">VA -&gt; Host</td>
<td align="left">Machines will not be able to boot, vaquero is effectively useless for that agent's site, but as a system vaquero still works and models are updated properly.</td>
<td align="left">Y</td>
</tr>
<tr class="odd">
<td align="left">VS -&gt; KV</td>
<td align="left">VS must shut down, because servers have lost the ability to participate in leader election, obtain models/status, and stay synchronized</td>
<td align="left">N</td>
</tr>
</tbody>
</table>
